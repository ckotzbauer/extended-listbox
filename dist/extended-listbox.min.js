/* extended-listbox v6.0.0,, @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self)["extended-listbox"]=t()}(this,(function(){"use strict";const e={searchBar:!1,searchBarWatermark:"Search...",searchBarButton:{visible:!1,icon:"",onClick:()=>null},getItems:()=>[],onValueChanged:()=>null,onFilterChanged:()=>null,onItemsChanged:()=>null,onItemEnterPressed:()=>null,onItemDoubleClicked:()=>null};class t{constructor(e,t,s){this.dataItems=[],(t=t||{}).searchBar=t.searchBar||!1,t.searchBarWatermark=t.searchBarWatermark||"Search...",t.searchBarButton=t.searchBarButton||{visible:!1},this._target=e,this._settings=t,this.multiple=s}_createListbox(){this._target.classList.add(t.MAIN_CLASS),this._settings.searchBar&&this._createSearchbar(),this._createList()}_createSearchbar(){const e=document.createElement("div");e.classList.add(t.SEARCHBAR_CLASS+"-wrapper"),this._target.appendChild(e);const s=document.createElement("input");if(s.classList.add(t.SEARCHBAR_CLASS),s.setAttribute("placeholder",this._settings.searchBarWatermark),e.appendChild(s),s.onkeyup=()=>{const e=s.value.toLowerCase();if(""!==e){const s=this._list.querySelectorAll("."+t.LIST_ITEM_CLASS);for(let i=0;i<s.length;i++){const l=s.item(i);if(l.classList.contains(t.LIST_ITEM_CLASS_GROUP))continue;-1!==l.innerText.toLowerCase().indexOf(e)?(l.style.display="block",l.parentElement&&(l.parentElement.style.display="block")):l.style.display="none"}const i=this._list.querySelectorAll("."+t.LIST_ITEM_CLASS_GROUP);for(let e=0;e<i.length;e++){const s=i.item(e),l=s.querySelectorAll("."+t.LIST_ITEM_CLASS);let n=-1;for(let e=0;e<l.length;e++)if("none"!==l.item(e).style.display){n=e;break}s.style.display=-1===n?"none":"block"}}else{const e=this._list.querySelectorAll("."+t.LIST_ITEM_CLASS);for(let t=0;t<e.length;t++){e.item(t).style.display="block"}}this._filterChanged()},this._settings.searchBarButton.visible){const s=document.createElement("button");if(s.id="searchBarButton",s.setAttribute("tabindex","-1"),s.classList.add(t.SEARCHBAR_BUTTON_CLASS),e.appendChild(s),this._settings.searchBarButton.onClick&&(s.onclick=this._settings.searchBarButton.onClick),this._settings.searchBarButton.icon){const e=document.createElement("i");this._settings.searchBarButton.icon.split(" ").forEach((t=>e.classList.add(t))),s.appendChild(e)}}this._searchbarWrapper=e,this._searchbar=s}_createList(){if(this._list=document.createElement("div"),this._list.classList.add(t.LIST_CLASS),this._target.appendChild(this._list),this._resizeListToListBox(),this._settings.getItems){const e=this._settings.getItems();if(e)for(const t in e)this.addItem(this._prepareDataItem(e[t]),!0)}}_generateItemId(){return"listBoxItem"+parseInt(""+1e7*Math.random(),10)}_prepareDataItem(e){let t={childItems:[],disabled:!1,groupHeader:null,id:this._generateItemId(),parentGroupId:null,selected:!1,text:null,index:null};if("string"==typeof e||"number"==typeof e)return t.text=e,t;{t=Object.assign(Object.assign({},t),e);const s=[];for(const e of t.childItems||[])s.push(this._prepareDataItem(e));return t.childItems=s,t}}_addItem(e,s,i){var l;this.dataItems.push(e);const n=document.createElement("div");if(n.classList.add(t.LIST_ITEM_CLASS),n.innerText=e.text,n.id=e.id,n.tabIndex=1,n.title=e.text,n.onkeydown=e=>{e.target.classList.contains(t.LIST_ITEM_CLASS_GROUP)||2!==e.eventPhase||(13===e.which?this._fireEvent(t.EVENT_ITEM_ENTER_PRESSED,this._getDataItem(e.target.id)):38===e.which?(e.preventDefault(),this._itemArrowUp(e.target)):40===e.which&&(e.preventDefault(),this._itemArrowDown(e.target)))},n.onclick=e=>{2===e.eventPhase&&this._itemClicked(e.target,e.ctrlKey)},n.ondblclick=e=>{e.target.classList.contains(t.LIST_ITEM_CLASS_GROUP)||this._fireEvent(t.EVENT_ITEM_DOUBLE_CLICKED,this._getDataItem(e.target.id))},e.disabled&&n.classList.add(t.LIST_ITEM_CLASS_DISABLED),e.groupHeader&&n.classList.add(t.LIST_ITEM_CLASS_GROUP),e.selected&&this._itemClicked(n,!0),e.parentGroupId){const t=this._locateItem(e.parentGroupId);t&&(i=t)}i&&n.classList.add(t.LIST_ITEM_CLASS_CHILD);let r=i||this._list;if(void 0===e.index||null===e.index||s?r.appendChild(n):(r=r.children.item(e.index),null===(l=r.parentElement)||void 0===l||l.insertBefore(n,r)),e.childItems&&e.childItems.length>0){n.classList.contains(t.LIST_ITEM_CLASS_GROUP)||n.classList.add(t.LIST_ITEM_CLASS_GROUP);for(let t=0;t<e.childItems.length;t++)this._addItem(this._prepareDataItem(e.childItems[t]),s,n)}return e.id}_resizeListToListBox(){const e=window.getComputedStyle(this._target,null),t=parseInt(e.getPropertyValue("padding-top"),10)+parseInt(e.getPropertyValue("padding-bottom"),10);let s=parseInt(e.getPropertyValue("height"),10)-t;this._settings.searchBar&&(s-=this._searchbarWrapper.offsetHeight),this._list.style.height=s+"px"}_clearItemSelection(e){e.classList.remove(t.LIST_ITEM_CLASS_SELECTED),this._getDataItem(e.id).selected=!1}_locateItem(e){var t;const s=null===(t=this.dataItems.find((t=>t.id===e||t.text===e)))||void 0===t?void 0:t.id,i=this._target.querySelector("#"+s);if(!i){const e=this._target.querySelectorAll('div[title="'+s+'"]');if(e.length>0)return e[0]}return i}_findNextItem(e,s){let i=e;for(;;){if(i="next"===s?i.nextElementSibling:i.previousElementSibling,!i){const t=e.parentElement;if(!t)return null;{const e="next"===s?t.nextElementSibling:t.previousElementSibling;if(!e)return null;const l=e.children;i=l.length>0?"next"===s?l[0].firstElementChild:l[0].lastElementChild:t}}if(!i||!i.classList.contains(t.LIST_ITEM_CLASS_DISABLED))return i}}_fireEvent(e,t){const s=this._settings["on"+e[0].toUpperCase()+e.substr(1)];s&&s({eventName:e,target:this._target,args:t})}_elementIndex(e){var t;return Array.prototype.slice.call(null===(t=e.parentElement)||void 0===t?void 0:t.children).indexOf(e)}_getDataItem(e){return this.dataItems.find((t=>t.id===e))||null}_itemArrowUp(e){const t=this._findNextItem(e,"previous");t&&(this._clearItemSelection(e),this._itemClicked(t))}_itemArrowDown(e){const t=this._findNextItem(e,"next");t&&(this._clearItemSelection(e),this._itemClicked(t))}addItem(e,s=!1){s||this.multiple||!e.selected||this.clearSelection();const i=this._addItem(this._prepareDataItem(e),s,null);return s||this._fireEvent(t.EVENT_ITEMS_CHANGED,this.getItems()),i}addItems(e){return e.map((e=>this.addItem(e)))}removeItem(e){var s;const i=this._locateItem(e);if(i){this._clearItemSelection(i),null===(s=i.parentElement)||void 0===s||s.removeChild(i);const e=this._getDataItem(i.id);this.dataItems.splice(this.dataItems.indexOf(e),1),this.onRemoveItem(e),this._fireEvent(t.EVENT_ITEMS_CHANGED,this.getItems())}}removeItems(e){e.forEach((e=>this.removeItem(e)))}destroy(){for(;this._target.firstChild;)this._target.removeChild(this._target.firstChild);this._target.classList.remove(t.MAIN_CLASS)}clearSelection(){const e=this._list.querySelectorAll("."+t.LIST_ITEM_CLASS);for(const s of Array.from(e))s.classList.remove(t.LIST_ITEM_CLASS_SELECTED),this._getDataItem(s.id).selected=!1}getItem(e){let t=null;const s=this._locateItem(e);return s&&(t=this._getDataItem(s.id)),t}getItems(){const e=[],t=this._list.children;for(const s of Array.from(t))e.push(this._getDataItem(s.id));return e}moveItemUp(e){var s;let i=null;const l=this._locateItem(e);return l&&l.previousElementSibling?(null===(s=l.parentElement)||void 0===s||s.insertBefore(l,l.previousElementSibling),i=this._elementIndex(l),this._getDataItem(l.id).index=i,this._fireEvent(t.EVENT_ITEMS_CHANGED,this.getItems())):l&&(i=this._elementIndex(l)),i}moveItemDown(e){var s;let i=null;const l=this._locateItem(e);return l&&l.nextElementSibling?(null===(s=l.parentNode)||void 0===s||s.insertBefore(l.nextElementSibling,l),i=this._elementIndex(l),this._getDataItem(l.id).index=i,this._fireEvent(t.EVENT_ITEMS_CHANGED,this.getItems())):l&&(i=this._elementIndex(l)),i}moveItemToTop(e){var s;let i=null;const l=this._locateItem(e);return l&&(null===(s=l.parentElement)||void 0===s||s.insertBefore(l,l.parentElement.firstElementChild),i=this._elementIndex(l),this._getDataItem(l.id).index=i,this._fireEvent(t.EVENT_ITEMS_CHANGED,this.getItems())),i}moveItemToBottom(e){var s;let i=null;const l=this._locateItem(e);return l&&(null===(s=l.parentElement)||void 0===s||s.appendChild(l),i=this._elementIndex(l),this._getDataItem(l.id).index=i),this._fireEvent(t.EVENT_ITEMS_CHANGED,this.getItems()),i}enable(e){e?this._target.classList.remove(t.MAIN_DISABLED_CLASS):this._target.classList.contains(t.MAIN_DISABLED_CLASS)||this._target.classList.add(t.MAIN_DISABLED_CLASS)}getSelection(){return this.selected}}t.MAIN_CLASS="listbox-root",t.MAIN_DISABLED_CLASS="listbox-disabled",t.LIST_CLASS="listbox",t.LIST_ITEM_CLASS="listbox-item",t.LIST_ITEM_CLASS_DISABLED="listbox-item-disabled",t.LIST_ITEM_CLASS_SELECTED="listbox-item-selected",t.LIST_ITEM_CLASS_GROUP="listbox-item-group",t.LIST_ITEM_CLASS_CHILD="listbox-item-child",t.SEARCHBAR_CLASS="listbox-searchbar",t.SEARCHBAR_BUTTON_CLASS="listbox-searchbar-button",t.EVENT_VALUE_CHANGED="valueChanged",t.EVENT_FILTER_CHANGED="filterChanged",t.EVENT_ITEMS_CHANGED="itemsChanged",t.EVENT_ITEM_ENTER_PRESSED="itemEnterPressed",t.EVENT_ITEM_DOUBLE_CLICKED="itemDoubleClicked";class s extends t{constructor(e,t){super(e,t,!1),this._selectedDomItem=null,this.selected=null,this._createListbox()}_itemClicked(e){if(e.classList.contains(t.LIST_ITEM_CLASS_DISABLED)||e.classList.contains(t.LIST_ITEM_CLASS_GROUP))return;this._selectedDomItem&&(this.clearSelection(),this._selectedDomItem=null),e.classList.toggle(t.LIST_ITEM_CLASS_SELECTED),e.focus(),this._selectedDomItem=e;const s=this._getDataItem(e.id);s.selected=!0,this.selected=s,this._fireEvent(t.EVENT_VALUE_CHANGED,this._getDataItem(e.id))}_filterChanged(){if(!this._selectedDomItem||"none"===this._selectedDomItem.style.display){const e=this._list.querySelectorAll("."+t.LIST_ITEM_CLASS);for(let s=0;s<e.length;s++){const i=e.item(s);if(!i.classList.contains(t.LIST_ITEM_CLASS_GROUP)&&!i.classList.contains(t.LIST_ITEM_CLASS_DISABLED)&&"none"!==i.style.display){this._itemClicked(i);break}}}this._fireEvent(t.EVENT_FILTER_CHANGED,this._searchbar.value)}clearSelection(){super.clearSelection(),this.selected=null}onRemoveItem(e){var t;e.id===(null===(t=this.selected)||void 0===t?void 0:t.id)&&(this.selected=null)}_clearItemSelection(e){super._clearItemSelection(e),this.selected=null}}class i extends t{constructor(e,t){super(e,t,!0),this.selected=[],this._createListbox()}_itemClicked(e,s=!1){if(e.classList.contains(t.LIST_ITEM_CLASS_DISABLED)||e.classList.contains(t.LIST_ITEM_CLASS_GROUP))return;const i=this._getDataItem(e.id);if(e.classList.contains(t.LIST_ITEM_CLASS_SELECTED))if(s){e.classList.remove(t.LIST_ITEM_CLASS_SELECTED),i.selected=!1;const s=this.selected.indexOf(this._getDataItem(e.id));this.selected.splice(s,1)}else this.clearSelection(),e.classList.add(t.LIST_ITEM_CLASS_SELECTED),i.selected=!0,this.selected.push(i);else s||this.clearSelection(),e.focus(),e.classList.add(t.LIST_ITEM_CLASS_SELECTED),i.selected=!0,this.selected.push(i);this._fireEvent(t.EVENT_VALUE_CHANGED,this.selected)}_filterChanged(){this._fireEvent(t.EVENT_FILTER_CHANGED,this._searchbar.value)}clearSelection(){super.clearSelection(),this.selected=[]}onRemoveItem(e){const t=this.selected.indexOf(e);-1!==t&&this.selected.splice(t,1)}_clearItemSelection(e){super._clearItemSelection(e);const t=this._getDataItem(e.id),s=this.selected.indexOf(t);this.selected.splice(s,1)}}function l(t,l,n){const r=Object.assign(Object.assign({},e),n);return"single"===l?new s(t,r):new i(t,r)}function n(e,t,s){const i=Array.prototype.slice.call(e).filter((e=>e instanceof HTMLElement)),n=[];for(let e=0;e<i.length;e++){const r=i[e];try{void 0!==r._listBox&&(r._listBox.destroy(),r._listBox=void 0),r._listBox=l(r,t,s||{}),n.push(r._listBox)}catch(e){console.error(e)}}return 1===n.length?n[0]:n}return function(e,t,s){return"string"==typeof e?n(window.document.querySelectorAll(e),t,s):e instanceof Node?n([e],t,s):n(e,t,s)}}));